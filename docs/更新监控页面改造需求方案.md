# 更新监控页面改造需求方案

## 文档信息

- **创建日期**: 2025-01-12
- **文档版本**: v1.0
- **作者**: Documentation Writer
- **关联文档**: 
  - [归档监控页面完整需求文档](./归档监控页面完整需求文档.md)
  - [归档监控页面改造-技术方案与实施计划](./归档监控页面改造-技术方案与实施计划.md)

---

## 一、需求背景

### 1.1 改造动机

归档监控页面经过改造后，采用了双视图模式（项目视图/个人视图），设计清晰、数据完整、交互流畅。用户反馈非常好，希望更新监控页面也能参照这个设计思路进行改造。

### 1.2 现有更新监控页面分析

当前更新监控页面具有以下特点：

**优点**：
- ✅ 热力图可视化直观，能快速识别准时/延迟状态
- ✅ 按项目分组展示，便于查看各项目的更新情况
- ✅ 支持按项目/按人员两种统计维度
- ✅ KPI卡片展示关键指标

**不足**：
- ❌ 缺少双视图切换（项目视图/个人视图）
- ❌ 无法查看单个项目或经办人的详细趋势
- ❌ 没有时间范围筛选（本周/本月/本年度更新查询功能）
- ❌ 热力图和统计表联动性不强

---

## 二、改造目标

### 2.1 核心目标

**参照归档监控页面的成功设计，实现更新监控的双视图模式，并新增时间范围查询功能。**

### 2.2 具体目标

1. **双视图模式**：实现项目视图和个人视图的切换
2. **详细数据展示**：点击项目/经办人后显示详细的更新情况和趋势
3. **时间范围查询**：支持查询本周/本月/本年度的更新数据
4. **数据联动**：热力图、统计表、详情区域数据联动展示
5. **保持现有优势**：保留热力图可视化的直观性

---

## 三、功能设计

### 3.1 双视图模式设计

#### 3.1.1 项目视图

**展示维度**：以项目为单位

**页面布局**：

```
┌────────────────────────────────────────────────────────┐
│ 页面标题: 更新监控                                    │
│ [项目视图] [个人视图]                    [全局筛选]  │
├────────────────────────────────────────────────────────┤
│ KPI卡片（4张）                                         │
│ ┌──────┬──────┬──────┬──────┐                        │
│ │项目数│准时率│事件数│延迟数│                        │
│ └──────┴──────┴──────┴──────┘                        │
├────────────────────────────────────────────────────────┤
│ 项目列表（带热力图）                                   │
│ ┌────────────────────────────────────────────────┐   │
│ │ 项目A [准时率: 85%]                            │   │
│ │ ┌─────────────────────────────────────────┐   │   │
│ │ │ 月度热力图（1-12月）                    │   │   │
│ │ │ 采购 [✓][✓][×][✓]...                   │   │   │
│ │ │ 合同 [✓][×][✓][✓]...                   │   │   │
│ │ │ 付款 [✓][✓][✓][✓]...                   │   │   │
│ │ │ 结算 [✓][✓][✓][✓]...                   │   │   │
│ │ └─────────────────────────────────────────┘   │   │
│ │ [查看详情]                                     │   │
│ └────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────┤
│ 详细统计表（按项目）                                   │
│ ┌────────────────────────────────────────────────┐   │
│ │ 项目│采购│合同│付款│结算│总计│准时率│          │   │
│ │ A   │8/10│9/10│10/10│5/10│32/40│80%│          │   │
│ └────────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────────┘
```

**主要功能**：
1. 显示所有项目的更新准时率
2. 每个项目显示月度热力图（采购/合同/付款/结算4个模块）
3. 点击"查看详情"展开该项目的详细信息

#### 3.1.2 个人视图

**展示维度**：以经办人为单位

**页面布局**：

```
┌────────────────────────────────────────────────────────┐
│ 页面标题: 更新监控                                    │
│ [项目视图] [个人视图]                    [全局筛选]  │
├────────────────────────────────────────────────────────┤
│ KPI卡片（4张）                                         │
│ ┌──────┬──────┬──────┬──────┐                        │
│ │经办人│准时率│事件数│延迟数│                        │
│ └──────┴──────┴──────┴──────┘                        │
├────────────────────────────────────────────────────────┤
│ 经办人列表表格                                         │
│ ┌────────────────────────────────────────────────┐   │
│ │ 姓名│项目数│准时事件│延迟事件│准时率│操作│     │   │
│ │ 张三│3个  │25      │5       │83%   │详情│     │   │
│ │ 李四│2个  │18      │2       │90%   │详情│     │   │
│ └────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────┤
│ 详细统计表（按人员）                                   │
│ ┌────────────────────────────────────────────────┐   │
│ │ 经办人│采购│合同│付款│结算│总计│准时率│       │   │
│ │ 张三  │8/10│9/10│10/10│5/10│32/40│80%│       │   │
│ └────────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────────┘
```

**主要功能**：
1. 显示所有经办人的更新准时率
2. 显示每个经办人负责的项目数
3. 点击"查看详情"展开该经办人的详细信息

### 3.2 详情展示设计

#### 3.2.1 项目详情（点击项目后弹出模态框）

**展示内容**：

```
┌────────────────────────────────────────────────────────┐
│ 项目详情: PRJ001 - XX项目名称            [关闭×]     │
├────────────────────────────────────────────────────────┤
│ 更新准时率统计                                         │
│ ┌──────┬──────┬──────┬──────┐                        │
│ │采购  │合同  │付款  │结算  │                        │
│ │85%   │90%   │100%  │75%   │                        │
│ └──────┴──────┴──────┴──────┘                        │
├────────────────────────────────────────────────────────┤
│ 月度更新趋势图                                         │
│ ┌────────────────────────────────────────────────┐   │
│ │     准时 vs 延迟（堆叠柱状图）                 │   │
│ │  10┤ ████████                                   │   │
│ │   8┤ ████████░░                                 │   │
│ │   6┤ ████████░░                                 │   │
│ │    └─1月─2月─3月─...                           │   │
│ │    ■准时 ░延迟                                 │   │
│ └────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────┤
│ 延迟记录明细（可切换模块：采购/合同/付款/结算）      │
│ [采购] [合同] [付款] [结算]                           │
│ ┌────────────────────────────────────────────────┐   │
│ │ 编号│业务日期│录入日期│截止日期│延迟天数│经办人│  │
│ │ P001│2024-12-20│2025-01-15│2025-01-31│0│张三│ │   │
│ │ P002│2024-12-25│延迟未录│2025-01-31│15│李四│ │   │
│ └────────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────────┘
```

#### 3.2.2 经办人详情（点击经办人后弹出模态框）

**展示内容**：类似项目详情，但数据范围是该经办人的所有业务

---

### 3.3 时间范围查询功能设计

#### 3.3.1 功能需求

用户需要快速查询某个时间范围内的更新情况：
- **本周**更新了哪些数据？
- **本月**更新了哪些数据？
- **本年度**更新了哪些数据？

#### 3.3.2 数据量评估

**潜在风险分析**：
- 本周：约12条记录（可直接展示）✅
- 本月：约50条记录（需分页展示）⚠️
- 本年度：约600条记录（必须分页+筛选）❌

**结论**：需要独立页面支持复杂查询和分页功能。

#### 3.3.3 推荐方案：双层设计

**第一层：主页快捷入口（轻量查询）**

在更新监控主页面底部添加快捷查询模块：

```
┌────────────────────────────────────────────────────────┐
│ 快捷查询 - 最近更新记录                               │
│ ┌────────────────────────────────────────────────┐   │
│ │ 📋 本周新增: 12条  本月新增: 50条             │   │
│ │ [查看本周详情] [查看本月详情] [高级查询>>]    │   │
│ └────────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────────┘
```

**第二层：独立查询页面（深度查询）**

创建独立页面：`/monitoring/update-records/`

**页面设计**：

```
┌────────────────────────────────────────────────────────┐
│ 更新记录查询                          [返回更新监控]  │
├────────────────────────────────────────────────────────┤
│ 筛选条件                                               │
│ ┌────────────────────────────────────────────────┐   │
│ │ 时间范围: ●本周 ○本月 ○本年度 ○自定义        │   │
│ │ 自定义:   [2024-12-01] 至 [2024-12-31]        │   │
│ │ 业务模块: ☑采购 ☑合同 ☑付款 ☑结算             │   │
│ │ 经办人:   [全部 ▼]                             │   │
│ │ 项目:     [全部 ▼]                             │   │
│ │ [重置] [查询]                                  │   │
│ └────────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────────┤
│ 统计摘要                                               │
│ ┌──────┬──────┬──────┬──────┬──────┐               │
│ │总记录│采购  │合同  │付款  │结算  │               │
│ │120   │25    │35    │45    │15    │               │
│ └──────┴──────┴──────┴──────┴──────┘               │
├────────────────────────────────────────────────────────┤
│ 更新记录列表                                           │
│ ┌────────────────────────────────────────────────┐   │
│ │录入日期│模块│编号  │名称│经办人│业务日期│项目││   │
│ │01-05   │采购│P001  │... │张三  │12-20   │A   ││   │
│ │01-05   │合同│C001  │... │李四  │12-22   │B   ││   │
│ │01-06   │付款│PAY01 │... │张三  │12-25   │A   ││   │
│ └────────────────────────────────────────────────┘   │
│ [« 上一页] 第1页/共3页 [下一页 »]                    │
├────────────────────────────────────────────────────────┤
│ 导出功能                                               │
│ [导出Excel] [导出CSV]                                 │
└────────────────────────────────────────────────────────┘
```

**功能特点**：
1. **灵活的时间筛选**：支持本周/本月/本年度快捷选项+自定义日期范围
2. 
